# Домашнее задание к занятию «Введение в микросервисы»

## Задача

Руководство крупного интернет-магазина, у которого постоянно растёт пользовательская база и количество заказов, рассматривает возможность переделки своей внутренней   ИТ-системы на основе микросервисов. 

Вас пригласили в качестве консультанта для оценки целесообразности перехода на микросервисную архитектуру. 

Опишите, какие выгоды может получить компания от перехода на микросервисную архитектуру и какие проблемы нужно решить в первую очередь.

### ОТВЕТ:
Сразу стоит отметить, что переход на микросервисы в этом случае не противопоказан, так как проект крупный, есть рабочая монолитная система и ожидается продолжение роста.

## Выгоды:
1. Распараллеливание работы над задачами
2. Повышение частоты релизов без координации между командами.
3. Повышение устойчивости системы к ошибкам, т.к. отказы в отдельных сервисах не должны приводить к падению всей системы, используются специальные техники: таймауты, прерыватель цепи, повтор, изоляция.
4. Масштабируемость — независимое масштабирование сервисов под нагрузку (например, каталог и корзина)
5. Можно использовать и пробовать разные технологии, выбирать стек под задачу (Python для ML, Go для высоконагруженных сервисов).

# Проблемы, которые стоит решить сразу:
## - Проблемы разработки
Сразу нужно уделить внимание проблемам разработки: автоматизировать CI/CD, совместимость api, версии артефактов, документация.

## - Проблемы эксплуатации
Сразу нужно задуматься о проблемах эксплуатации: мониторинг, логгирование, управление инфраструктурой.

## - Организационные вопросы
1. Команды, которые будут разрабатывать сервисы должны быть кроссфункциональны, чтобы не зависеть друг от друга. Т.е. распределяя человеческие ресурсы нужно сформировать в общем случае самостоятельные равноценные команды разработчиков.
   
2. Так как есть монолит, вероятно, можно начать с выделения или формирования одной выделенной команды, которая займется созданием первых нескольких микросервисов. Далее по мере возникновения задач и в зависимости от эффекта от перехода на микросервисы, будут сформированы другие команды сервисов.

3. Для команд определить модель владения

## - Технические решения
1. Проектировать сервисы, ориентируясь на структуру организации и группируя схожие бизнес-функции. В проектировании использовать DDD.

2. Выбрать способ координации действий микросервисов: оркестрация или хореография. (Хореография кажется предпочтительной, т.к. не централизует логику в отдельном управляющем сервисе). Выбрать протоколы интеграции для межсервисного взаимодействия.

3. Синхронное и асинхронное взаимодействие:
Для интернет-магазина:
Синхронное (REST/gRPC) — чтение каталога, проверка наличия, получение цен.
Асинхронное (Event-based) — оформление заказа, уведомления, обработка платежей.

4. Обеспечить идемпотентность операций - техника работы с ошибками, которая позволяет безопасно повторять запросы при сетевых проблемах, исключая бизнес-ошибки при повторах (повторное выполнение операции с теми же параметрами должно давать тот же результат, что и первое выполнение).

## - Антипаттерны
Не делать микросервисы самоцелью. Цель — скорость и качество поставки.
Избегать наносервисов, не делать слишком мелкие сервисы. Стоит ориентироваться на соотношение 1 сервис на 1 команду.
Не считать микросервисы «серебряной пулей», микросервисы только добавят технической сложности, но и дадут возможность более гибко развивать систему.